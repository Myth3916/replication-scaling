# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ: –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ" - –®–∞—Ä–æ–≤ –û–ª–µ–≥

## –ó–∞–¥–∞–Ω–∏–µ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Master-Slave —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ MySQL

### –û–ø–∏—Å–∞–Ω–∏–µ
–ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è —Ç–∏–ø–∞ **Master ‚Üí Slave** –¥–ª—è –°–£–ë–î MySQL 8.0 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker.

### –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã

![–°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã](screenshots/–°—Ö–µ–º–∞–†–∞–±–æ—Ç—ã.png)


### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

![–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](screenshots/–°—Ç—Ä—É–∫—Ç—É—Ä–∞–ü—Ä–æ–µ–∫—Ç–∞.png)


### –ó–∞–ø—É—Å–∫ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

```bash
# –°—Ç–∞—Ç—É—Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–∞ slave
docker exec mysql-slave mysql -uroot -prootpass -e "SHOW SLAVE STATUS\G" | grep Running

# –¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–ø–∏—Å—å –Ω–∞ master
docker exec mysql-master mysql -uroot -prootpass sakila -e \
  "CREATE TABLE test_replication (id INT AUTO_INCREMENT PRIMARY KEY, msg VARCHAR(50)); \
   INSERT INTO test_replication (msg) VALUES ('–†–µ–ø–ª–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç!');"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ slave (—á–µ—Ä–µ–∑ 2 —Å–µ–∫)
sleep 2
docker exec mysql-slave mysql -uroot -prootpass sakila -e "SELECT * FROM test_replication;"
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

![–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è](screenshots/–ü–∞—Ä–∞–º–µ—Ç—Ä—ã–ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è.png)

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø–ª–∞–≥–∏–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ `mysql_native_password` –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `repl` (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π –≤ MySQL 8.0)
- Slave –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ —Ä–µ–∂–∏–º–µ `read-only` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–π –∑–∞–ø–∏—Å–∏
- –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö `master-data/` –∏ `slave-data/` –Ω–∞ —Ö–æ—Å—Ç–µ

## –°–∫—Ä–∏–Ω—à–æ—Ç—ã
–°–º. –∫–∞—Ç–∞–ª–æ–≥ screenshots/

–°–∫—Ä–∏–Ω—à–æ—Ç 1: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è master

![–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è master](screenshots/01-master-config.png)

–°–∫—Ä–∏–Ω—à–æ—Ç 2: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è slave

![–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è slave](screenshots/02-slave-config.png)

–°–∫—Ä–∏–Ω—à–æ—Ç 3: –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

![–°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤](screenshots/03-containers.png)

–°–∫—Ä–∏–Ω—à–æ—Ç 4: –°—Ç–∞—Ç—É—Å master

![–°—Ç–∞—Ç—É—Å master](screenshots/04-master-status.png)

–°–∫—Ä–∏–Ω—à–æ—Ç 5: –°—Ç–∞—Ç—É—Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

![–°—Ç–∞—Ç—É—Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏](screenshots/05-slave-status.png)

–°–∫—Ä–∏–Ω—à–æ—Ç 6: –¢–µ—Å—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

![–¢–µ—Å—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏](screenshots/06-replication-test.png)



##  –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ 2: –ü–ª–∞–Ω —à–∞—Ä–¥–∏–Ω–≥–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 1. –ü—Ä–∏–Ω—Ü–∏–ø—ã –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
üîπ** –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —à–∞—Ä–¥–∏–Ω–≥ (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º)**
- –ß—Ç–æ –¥–µ–ª–∏—Ç: –°—Ç–æ–ª–±—Ü—ã (–∞—Ç—Ä–∏–±—É—Ç—ã) –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
- –ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:
  - –¢–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç ¬´—Ç—è–∂—ë–ª—ã–µ¬ª –ø–æ–ª—è (BLOB, TEXT), –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
  - –ß–∞—Å—Ç—å –ø–æ–ª–µ–π –∏–º–µ–µ—Ç —Ä–∞–∑–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–∞—Ä–æ–ª–∏ vs –ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

- **–ü—Ä–∏–º–µ—Ä –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:**
   - –®–∞—Ä–¥ 1: id, email, –ø–∞—Ä–æ–ª—å_hash ‚Äî –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã–µ
   - –®–∞—Ä–¥ 2: –∏–º—è, —Ñ–æ—Ç–æ_blob, –∞–¥—Ä–µ—Å, —Ç–µ–ª–µ—Ñ–æ–Ω ‚Äî –ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
üîπ **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —à–∞—Ä–¥–∏–Ω–≥ (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç—Ä–æ–∫–∞–º)**

- –ß—Ç–æ –¥–µ–ª–∏—Ç: –°—Ç—Ä–æ–∫–∏ (–∑–∞–ø–∏—Å–∏) —Ç–∞–±–ª–∏—Ü—ã –ø–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–º—É –∫—Ä–∏—Ç–µ—Ä–∏—é
- –ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:
  - –¢–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∏–ª–ª–∏–æ–Ω—ã –∑–∞–ø–∏—Å–µ–π
  - –ù–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –≥–µ–æ–≥—Ä–∞—Ñ–∏–∏, –¥–∏–∞–ø–∞–∑–æ–Ω—É ID –∏–ª–∏ –±–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç—è–º
- **–ü—Ä–∏–º–µ—Ä –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –º–∞–≥–∞–∑–∏–Ω—ã:**
  - –®–∞—Ä–¥ 1: –º–∞–≥–∞–∑–∏–Ω—ã –ú–æ—Å–∫–≤—ã (–≥–æ—Ä–æ–¥ = '–ú–æ—Å–∫–≤–∞')
  - –®–∞—Ä–¥ 2: –º–∞–≥–∞–∑–∏–Ω—ã –°–ü–± (–≥–æ—Ä–æ–¥ = '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥')
  - –®–∞—Ä–¥ 3: –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã


















